// Prisma schema for PDF Download Analytics
// The generator MUST always be prisma-client-js
// The datasource provider (sqlite/postgresql/mysql) is changed during Docker build

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model DownloadEvent {
  id            String   @id @default(uuid())
  url           String
  statusCode    Int
  timestamp     DateTime @default(now())
  userAgent     String?
  responseTime  Int?
  errorMessage  String?

  @@index([statusCode])
  @@index([url])
  @@index([statusCode, timestamp])
  @@index([timestamp])
  @@map("download_events")
}

model PdfProcessingEvent {
  id              String   @id @default(uuid())
  url             String
  success         Boolean
  timestamp       DateTime @default(now())
  userAgent       String?
  processingTime  Int?
  errorMessage    String?
  errorType       String?

  @@index([success])
  @@index([url])
  @@index([success, timestamp])
  @@index([timestamp])
  @@map("pdf_processing_events")
}
